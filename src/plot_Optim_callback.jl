using Plots # 
using LaTeXStrings # for LaTeX labels
using ColorBrewer # for better colors



data = Dict()
#    time                   iteration      q(λ)           |Dq(λ)|
push!(data,
    "D2q" => [
        1551149960     NaN NaN NaN
        1551150019.9061338902     0     6.541958e-02     5.495858e-02
        1551150076.0596220493     1     1.415066e-02     2.477936e-02
        1551150130.7264719009     2     8.033722e-03     2.222672e-03
        1551150182.8285150528     3     7.626427e-03     6.482999e-04
        1551150227.7336139679     4     7.623451e-03     3.599581e-06
        1551150254.8408119678     5     7.623451e-03     2.637273e-09
    ]
)

push!(data,
    "FDDq" => [
        1551150254     NaN NaN NaN
        1551150510.9229331017     0     6.541958e-02     5.495858e-02
        1551150763.8934819698     1     1.436116e-02     2.516030e-02
        1551151015.3333981037     2     8.052481e-03     2.266362e-03
        1551151266.9473400116     3     7.626493e-03     7.194864e-04
        1551151513.7511041164     4     7.623451e-03     1.958528e-06
        1551151541.5534648895     5     7.623451e-03     2.774965e-09
    ]
)

push!(data,
    "ADDq" => [
        1551151541     NaN NaN NaN
        1551151756.3082830906     0     6.541958e-02     5.495858e-02
        1551152178.9288620949     1     1.415066e-02     2.477936e-02
        1551152624.4756920338     2     8.033722e-03     2.222672e-03
        1551152925.9115319252     3     7.626427e-03     6.482999e-04
        1551153284.8693869114     4     7.623451e-03     3.599573e-06
        1551153312.6281049252     5     7.623451e-03     2.661079e-09
    ]
)

push!(data,
    "CSDDq" => [
        1551153312     NaN NaN NaN
        1551153792.2142388821     0     6.541958e-02     5.495858e-02
        1551154774.6777191162     1     1.415066e-02     2.477936e-02
        1551155349.13905406       2     8.033722e-03     2.222672e-03
        1551155913.8560130596     3     7.626427e-03     6.482999e-04
        1551156558.5880250931     4     7.623451e-03     3.599569e-06
        1551156586.3236908913     5     7.623451e-03     2.659070e-09
    ]
)

list_methods = [
    "D2q"
    "FDDq"
    "ADDq"
    "CSDDq"
]

function mystepped_x_and_y(times, values)
    t₀ = times[1]
    x = [t₀]
    oldv = values[2]
    y = [oldv]
    for (t, v) in zip(times[2:end], values[2:end])
        push!(x, t)
        push!(x, t)
        push!(y, oldv)
        push!(y, v)
        oldv = v
    end
    return x .- t₀, y
end

p = plot()
for (i, method) in enumerate(list_methods)
    x, y = mystepped_x_and_y(data[method][:, 1], data[method][:, 4])
    global p
    p = plot!(p,
        x, y,
        color=ColorBrewer.palette("Set1", 4)[i],
        label=method,
    )
end

p = plot!(p,
    legend=:topright,
    xlabel="Time (Seconds)",
    ylabel="Norm of gradient",
    xminorticks=0:60:3600,
    xticks=0:300:3600,
    yaxis=:log
)


display(p)
savefig(p, "fig/Optim_callback_katana.pdf")
display(p)

#=

┌────────────────────────
│ Optimizing using method D2q, and printing time and q :
│
│    time                   iteration      q(λ)           |Dq(λ)|
│    1551150019.9061338902     0     6.541958e-02     5.495858e-02
│    1551150076.0596220493     1     1.415066e-02     2.477936e-02
│    1551150130.7264719009     2     8.033722e-03     2.222672e-03
│    1551150182.8285150528     3     7.626427e-03     6.482999e-04
│    1551150227.7336139679     4     7.623451e-03     3.599581e-06
│    1551150254.8408119678     5     7.623451e-03     2.637273e-09
└────────────────────────

┌────────────────────────
│ Optimizing using method FDDq, and printing time and q :
│
│    time                   iteration      q(λ)           |Dq(λ)|
│    1551150510.9229331017     0     6.541958e-02     5.495858e-02
│    1551150763.8934819698     1     1.436116e-02     2.516030e-02
│    1551151015.3333981037     2     8.052481e-03     2.266362e-03
│    1551151266.9473400116     3     7.626493e-03     7.194864e-04
│    1551151513.7511041164     4     7.623451e-03     1.958528e-06
│    1551151541.5534648895     5     7.623451e-03     2.774965e-09
└────────────────────────

┌────────────────────────
│ Optimizing using method ADDq, and printing time and q :
│
│    time                   iteration      q(λ)           |Dq(λ)|
│    1551151756.3082830906     0     6.541958e-02     5.495858e-02
│    1551152178.9288620949     1     1.415066e-02     2.477936e-02
│    1551152624.4756920338     2     8.033722e-03     2.222672e-03
│    1551152925.9115319252     3     7.626427e-03     6.482999e-04
│    1551153284.8693869114     4     7.623451e-03     3.599573e-06
│    1551153312.6281049252     5     7.623451e-03     2.661079e-09
└────────────────────────

┌────────────────────────
│ Optimizing using method CSDDq, and printing time and q :
│
│    time                   iteration      q(λ)           |Dq(λ)|
│    1551153792.2142388821     0     6.541958e-02     5.495858e-02
│    1551154774.6777191162     1     1.415066e-02     2.477936e-02
│    1551155349.13905406     2     8.033722e-03     2.222672e-03
│    1551155913.8560130596     3     7.626427e-03     6.482999e-04
│    1551156558.5880250931     4     7.623451e-03     3.599569e-06
│    1551156586.3236908913     5     7.623451e-03     2.659070e-09
└────────────────────────

=#
